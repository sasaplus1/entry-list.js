{"version":3,"file":"entry-list.js","sources":["../../index.ts"],"sourcesContent":["type Entry = {\n  key: (string | number | symbol)[];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any;\n};\n\ntype Options = {\n  collectSymbol: boolean;\n};\n\nexport function entryList(\n  value: unknown,\n  options: Options = { collectSymbol: false }\n): Entry[] {\n  const { collectSymbol } = options;\n\n  const getKeys = collectSymbol\n    ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      function (value: Record<string, any>): (string | number | symbol)[] {\n        return Array.isArray(value)\n          ? Object.keys(value)\n          : Reflect.ownKeys(value);\n      }\n    : // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      function (value: Record<string, any>): string[] {\n        return Object.keys(value);\n      };\n\n  const result: Entry[] = [];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const references: WeakSet<any> = new WeakSet();\n\n  const getEntries = function getEntries(\n    value: unknown,\n    prefix: (string | number | symbol)[] = []\n  ): Entry[] {\n    if (value !== null && typeof value === 'object') {\n      references.add(value);\n\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore 2345\n      const keys = getKeys(value);\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      for (const key of keys) {\n        // NOTE: https://github.com/microsoft/TypeScript/issues/1863\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const v = (value as Record<string | symbol, any>)[key as any];\n\n        if (references.has(v)) {\n          result.push({\n            value: v,\n            key: [...prefix, key]\n          });\n        } else {\n          getEntries(v, [...prefix, key]);\n        }\n      }\n    } else {\n      result.push({ value, key: prefix });\n    }\n\n    return result;\n  };\n\n  return getEntries(value);\n}\n"],"names":[],"mappings":";;;;;;;;;;;WAQgB,SAAS,CAAC,KAAc,EAAE,UAAmB,EAAE,aAAa,EAAE,KAAK,EAAE;MACjF,MAAM,EAAE,aAAa,EAAE,GAAG,OAAO,CAAC;MAClC,MAAM,OAAO,GAAG,aAAa;;cAErB,UAAU,KAA0B;kBAChC,OAAO,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;wBACrB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;wBAClB,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;eAChC;;cAED,UAAU,KAA0B;kBAChC,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;eAC7B,CAAC;MACV,MAAM,MAAM,GAAY,EAAE,CAAC;;MAE3B,MAAM,UAAU,GAAiB,IAAI,OAAO,EAAE,CAAC;MAC/C,MAAM,UAAU,GAAG,SAAS,UAAU,CAAC,KAAc,EAAE,SAAuC,EAAE;UAC5F,IAAI,KAAK,KAAK,IAAI,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;cAC7C,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;;;cAGtB,MAAM,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;;cAE5B,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;;;kBAGpB,MAAM,CAAC,GAAI,KAAsC,CAAC,GAAU,CAAC,CAAC;kBAC9D,IAAI,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;sBACnB,MAAM,CAAC,IAAI,CAAC;0BACR,KAAK,EAAE,CAAC;0BACR,GAAG,EAAE,CAAC,GAAG,MAAM,EAAE,GAAG,CAAC;uBACxB,CAAC,CAAC;mBACN;uBACI;sBACD,UAAU,CAAC,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC;mBACnC;eACJ;WACJ;eACI;cACD,MAAM,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,CAAC,CAAC;WACvC;UACD,OAAO,MAAM,CAAC;OACjB,CAAC;MACF,OAAO,UAAU,CAAC,KAAK,CAAC,CAAC;EAC7B;;;;;;;;;;"}